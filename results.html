<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Server Room Lockdown - Results</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container results-page">
    <h1>üéâ Mission Complete!</h1>
    <p><strong>Player:</strong> <span id="playerName"></span></p>
    <p><strong>Chapter:</strong> <span id="chapterPlayed"></span></p>
    <p><strong>Time Taken:</strong> <span id="timeTaken"></span> seconds</p>
    <p><strong>Score:</strong> <span id="score"></span> correct / <span id="wrong"></span> wrong</p>

    <div class="results-buttons">
      <button onclick="goToChapters()">üîÅ Play Another Chapter</button>
      <button onclick="downloadCertificate()">üìÑ Download Certificate</button>
      <a id="whatsappShare" href="#" target="_blank">
        <button>üì§ Share on WhatsApp</button>
      </a>
      <a href="https://forms.gle/YOUR_GOOGLE_FORM_LINK" target="_blank">
        <button>üìù Submit Feedback</button>
      </a>
    </div>
  </div>

  <script>
    const playerName = localStorage.getItem('playerName') || 'Unknown Player';
    const chapter = localStorage.getItem('selectedChapterTitle') || 'Unknown Chapter';
    const time = localStorage.getItem('timeTaken') || '0';
    const correct = localStorage.getItem('correctCount') || '0';
    const wrong = localStorage.getItem('wrongCount') || '0';

    document.getElementById('playerName').textContent = playerName;
    document.getElementById('chapterPlayed').textContent = chapter;
    document.getElementById('timeTaken').textContent = time;
    document.getElementById('score').textContent = correct;
    document.getElementById('wrong').textContent = wrong;

    // WhatsApp share link
    const message = `I just completed "${chapter}" in Server Room Lockdown! ‚úÖ Score: ${correct} / ‚ùå ${wrong} in ‚è±Ô∏è ${time}s`;
    const shareURL = `https://wa.me/?text=${encodeURIComponent(message)}`;
    document.getElementById('whatsappShare').href = shareURL;

    // Certificate download (basic implementation)
    function downloadCertificate() {
      const text = `
        üéì Certificate of Completion
        This certifies that ${playerName}
        completed "${chapter}"
        Score: ${correct} correct, ${wrong} wrong
        Time Taken: ${time}s
      `;
      const blob = new Blob([text], { type: "text/plain" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `${playerName}_certificate.txt`;
      link.click();
    }

    function goToChapters() {
      window.location.href = 'chapters.html';
    }

    // Submit to Google Form leaderboard
    const formURL = 'https://docs.google.com/forms/d/e/YOUR_FORM_ID/formResponse';
    const formData = new FormData();
    formData.append('entry.1234567890', playerName); // Name
    formData.append('entry.2345678901', chapter);    // Chapter
    formData.append('entry.3456789012', time);       // Time
    formData.append('entry.4567890123', correct);    // Correct
    formData.append('entry.5678901234', wrong);      // Wrong

    fetch(formURL, {
      method: 'POST',
      mode: 'no-cors',
      body: formData
    });
  </script>
</body>
</html>
